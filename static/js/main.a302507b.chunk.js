(this.webpackJsonpsimplechat=this.webpackJsonpsimplechat||[]).push([[0],{17:function(e,t,n){e.exports={loader:"Preloader_loader__37WlW"}},24:function(e,t,n){},26:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(3),s=n.n(c),i=n(16),r=n.n(i),o=(n(24),n(11)),l=n.n(o),u=n(14),j=n(7),d=(n(26),n(17)),b=n.n(d),m=n.p+"static/media/preloader.967465df.svg",h=function(e){return Object(a.jsx)("div",{className:b.a.loader,children:Object(a.jsx)("img",{src:m})})},O=n(9),p=(n(31),n(28),n(32),n(18)),f=n(15);O.a.apps.length?O.a.app():O.a.initializeApp({apiKey:"AIzaSyCTFiYhbsWddczgofjfgEgP-i7viAOUgxQ",authDomain:"simplechat-5073a.firebaseapp.com",databaseURL:"https://simplechat-5073a-default-rtdb.firebaseio.com",projectId:"simplechat-5073a",storageBucket:"simplechat-5073a.appspot.com",messagingSenderId:"1032940693503",appId:"1:1032940693503:web:35e1f6d9fecbd8ab12e9ca"});var x=O.a.auth(),g=O.a.firestore(),v=O.a.storage().ref().child("img");function N(e){var t=Object(c.useState)(""),n=Object(j.a)(t,2),s=n[0],i=n[1],r=g.collection("users"),o=r.orderBy("nickname"),d=Object(c.useState)(!1),b=Object(j.a)(d,2),m=b[0],h=b[1],O=Object(f.a)(o,{idField:"id"}),p=Object(j.a)(O,1)[0],v=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=x.currentUser.uid,m){e.next=5;break}return e.next=5,r.add({nickname:s,uid:a});case 5:n.user.updateProfile({displayName:s}),n.setUpdate(!1);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(a.jsx)("div",{className:"fade",children:Object(a.jsxs)("form",{className:"nickForm",onSubmit:function(t){return v(t,e)},children:["Please, input your nickname",Object(a.jsx)("div",{className:"nickname",children:Object(a.jsx)("input",{type:"text",placeholder:"nickname",value:s,onChange:function(e){i(e.target.value),h(!1),p.some((function(t){return t.nickname===e.target.value}))&&h(!0)}})}),Object(a.jsx)("p",{className:"errNick",children:m?"Name is already taken":null}),Object(a.jsx)("button",{className:"submit",disabled:m,children:"Submit"})]})})}function S(e){var t=Object(c.useState)(!1),n=Object(j.a)(t,2),s=n[0],i=n[1],r=function(e){var t=Object(c.useState)(!1),n=Object(j.a)(t,2),s=n[0],i=n[1],r=Object(c.useState)(""),o=Object(j.a)(r,2),l=o[0],u=o[1],d=Object(c.useState)(""),b=Object(j.a)(d,2),m=b[0],h=b[1],p=Object(c.useState)(""),f=Object(j.a)(p,2),x=f[0],g=f[1],v=function(e){g(e)};return Object(a.jsxs)("div",{className:"fade",children:[Object(a.jsx)("div",{className:"close",onClick:e.SignInWithEmailPop,children:"\u2716"}),Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault(),O.a.auth().createUserWithEmailAndPassword(l,m).catch({function:function(e){var t=e.code,n=e.message;v("auth/weak-password"===t?"The password is too weak":n)}}),O.a.auth().signInWithEmailAndPassword(l,m).catch((function(e){var t=e.message;v(t)}))},className:"formLog",children:[Object(a.jsx)("input",{className:"login",type:"text",placeholder:"E-mail",value:l,onChange:function(e){return u(e.target.value)}}),Object(a.jsxs)("div",{className:"passRow",children:[Object(a.jsx)("input",{type:s?"text":"password",placeholder:"password",value:m,onChange:function(e){return h(e.target.value)}}),Object(a.jsx)("button",{onClick:function(){i(s=!s)},children:s?" \u2796 ":"\ud83d\udc41\ufe0f"})]}),Object(a.jsxs)("div",{className:"error",children:[Object(a.jsx)("p",{children:x}),Object(a.jsx)("button",{className:"submit",children:"Submit"})]})]})]})},o=function(){i(s=!s)};return Object(a.jsxs)("section",{className:"signInRow",children:[s?Object(a.jsx)(r,{SignInWithEmailPop:o}):null,Object(a.jsx)("button",{className:"email",onClick:o,children:"Sign up with e-mail"}),Object(a.jsx)("button",{className:"email",onClick:o,children:"Sign in with e-mail"}),Object(a.jsx)("button",{className:"google",onClick:function(e){var t=new O.a.auth.GoogleAuthProvider;x.signInWithPopup(t).then((function(e){e.user.displayName}))},children:"Sign in with Google"}),Object(a.jsx)("button",{className:"anon",onClick:function(){O.a.auth().signInAnonymously()},children:"Sign like anonim(with restriction)"})]})}function k(e){return x.currentUser&&Object(a.jsx)("button",{className:"signOut",onClick:function(){x.signOut()},children:"Sign Out"})}function w(e){var t=e.message,n=t.text,c=t.uid,s=t.photoURL,i=t.name,r=void 0===i?"Anonim":i,o=c===x.currentUser.uid?"sent":"received";return Object(a.jsxs)("div",{className:"message ".concat(o),children:[Object(a.jsx)("img",{src:s}),Object(a.jsxs)("div",{className:"msgRow",children:[Object(a.jsx)("p",{className:"name",children:r}),Object(a.jsx)("p",{className:"msg",children:n})]})]})}function y(e){var t=Object(c.useRef)(),n=Object(c.useState)(""),s=Object(j.a)(n,2),i=s[0],r=s[1];v.child("user.png").getDownloadURL().then((function(e){r(e)}));var o=g.collection("messages"),d=o.orderBy("createdAt").limit(30),b=Object(f.a)(d,{idField:"id"}),m=Object(j.a)(b,1)[0],p=Object(c.useState)(""),S=Object(j.a)(p,2),k=S[0],y=S[1],C=Object(c.useState)(!0),U=Object(j.a)(C,2),I=U[0],P=U[1],A=function(){var e=Object(u.a)(l.a.mark((function e(n){var a,c,s,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a=O.a.auth().currentUser.displayName,c=x.currentUser,s=c.uid,r=c.photoURL,""===k){e.next=6;break}return e.next=6,o.add({text:k,createdAt:O.a.firestore.FieldValue.serverTimestamp(),uid:s,photoURL:null!==r?r:i,name:a});case 6:y(""),t.current.scrollIntoView({behavior:"smooth"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[I?Object(a.jsx)(N,{setUpdate:P,user:e.user}):null,Object(a.jsxs)("section",{children:[Object(a.jsxs)("div",{className:"messageSection",children:[void 0===m?Object(a.jsx)(h,{}):m&&m.map((function(e){return Object(a.jsx)(w,{message:e},e.id)})),Object(a.jsx)("div",{ref:t})]}),Object(a.jsxs)("form",{onSubmit:A,className:"form",children:[Object(a.jsx)("textarea",{value:k,onChange:function(e){return y(e.target.value)}}),Object(a.jsx)("button",{type:"submit",children:"Send"})]})]})]})}var C=function(){var e=Object(p.a)(x),t=Object(j.a)(e,3),n=t[0],c=t[1];return t[2],Object(a.jsxs)("div",{className:"App",children:[Object(a.jsxs)("header",{children:[Object(a.jsx)("div",{className:"title",children:Object(a.jsx)("p",{children:"Simple Chat"})}),n?Object(a.jsx)(k,{}):null]}),Object(a.jsx)("div",{className:"container",children:Object(a.jsx)("main",{children:c?Object(a.jsx)(h,{}):null===n?Object(a.jsx)(S,{}):Object(a.jsx)(y,{user:n})})})]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,33)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};r.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(C,{})}),document.getElementById("root")),U()}},[[30,1,2]]]);
//# sourceMappingURL=main.a302507b.chunk.js.map